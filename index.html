<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snortstamper - YouTube Chapter Generator</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@heroicons/react@2/24/outline/index.js" type="module"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script>
        const { useState } = React;
        const { createRoot } = ReactDOM;

        function SnortstamperUI() {
            const [file, setFile] = useState(null);
            const [loading, setLoading] = useState(false);
            const [result, setResult] = useState(null);
            const [error, setError] = useState(null);

            const handleFileChange = (e) => {
                const selectedFile = e.target.files?.[0];
                if (selectedFile) {
                    setFile(selectedFile);
                    setError(null);
                    setResult(null);
                }
            };

            const handleSubmit = async () => {
                if (!file) {
                    setError('Please select a transcript file');
                    return;
                }

                setLoading(true);
                setError(null);
                setResult(null);

                try {
                    const formData = new FormData();
                    formData.append('transcript', file);

                    const response = await fetch('/api/generate-timestamps', {
                        method: 'POST',
                        body: formData,
                    });

                    if (!response.ok) {
                        throw new Error(`Server error: ${response.statusText}`);
                    }

                    const data = await response.json();
                    if (data.error) {
                        throw new Error(data.error);
                    }

                    setResult(data.timestamps);
                } catch (err) {
                    setError(err.message || 'Failed to generate timestamps');
                } finally {
                    setLoading(false);
                }
            };

            const handleDownload = () => {
                if (!result) return;

                const element = document.createElement('a');
                element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(result));
                element.setAttribute('download', 'youtube_chapters.txt');
                element.style.display = 'none';
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);
            };

            return React.createElement(
                'div',
                { className: 'min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-6' },
                React.createElement(
                    'div',
                    { className: 'max-w-2xl mx-auto' },
                    React.createElement(
                        'div',
                        { className: 'bg-slate-700 rounded-lg shadow-2xl p-8' },
                        React.createElement('h1', { className: 'text-3xl font-bold text-white mb-2' }, 'Snortstamper'),
                        React.createElement('p', { className: 'text-slate-300 mb-8' }, 'Generate YouTube chapters from video transcripts'),
                        React.createElement(
                            'div',
                            { className: 'space-y-6' },
                            React.createElement(
                                'div',
                                { className: 'border-2 border-dashed border-slate-500 rounded-lg p-8 hover:border-slate-400 transition' },
                                React.createElement(
                                    'label',
                                    { className: 'flex flex-col items-center justify-center cursor-pointer' },
                                    React.createElement('div', { className: 'w-12 h-12 text-slate-400 mb-3' }, 'üìÑ'),
                                    React.createElement(
                                        'span',
                                        { className: 'text-white font-medium' },
                                        file ? file.name : 'Click to upload transcript'
                                    ),
                                    React.createElement(
                                        'span',
                                        { className: 'text-slate-400 text-sm mt-2' },
                                        file ? 'File selected' : 'or drag and drop'
                                    ),
                                    React.createElement('input', {
                                        type: 'file',
                                        accept: '.txt',
                                        onChange: handleFileChange,
                                        className: 'hidden'
                                    })
                                )
                            ),
                            error && React.createElement(
                                'div',
                                { className: 'bg-red-900 border border-red-700 rounded-lg p-4 flex items-start gap-3' },
                                React.createElement('div', { className: 'w-5 h-5 text-red-300 flex-shrink-0 mt-0.5' }, '‚ö†Ô∏è'),
                                React.createElement('p', { className: 'text-red-200 text-sm' }, error)
                            ),
                            React.createElement(
                                'button',
                                {
                                    onClick: handleSubmit,
                                    disabled: !file || loading,
                                    className: 'w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-semibold py-3 rounded-lg transition flex items-center justify-center gap-2'
                                },
                                loading ? '‚è≥ Generating timestamps...' : '‚ú® Generate Timestamps'
                            )
                        ),
                        result && React.createElement(
                            'div',
                            { className: 'mt-8 space-y-4' },
                            React.createElement(
                                'div',
                                { className: 'bg-slate-600 rounded-lg p-6' },
                                React.createElement('h2', { className: 'text-white font-semibold mb-4' }, 'Generated Chapters:'),
                                React.createElement(
                                    'pre',
                                    { className: 'text-slate-200 text-sm whitespace-pre-wrap break-words bg-slate-800 p-4 rounded max-h-64 overflow-y-auto font-mono' },
                                    result
                                )
                            ),
                            React.createElement(
                                'button',
                                {
                                    onClick: handleDownload,
                                    className: 'w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 rounded-lg transition flex items-center justify-center gap-2'
                                },
                                '‚¨áÔ∏è Download Chapters'
                            )
                        )
                    )
                )
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(SnortstamperUI));
    </script>
</body>
</html>